<!DOCTYPE html>
<html>
	<head>
		<title></title>
		<link rel="stylesheet" type="text/css" href="../css/stylesheet.css">
	</head>
	<body>
		<script src="https://smtpjs.com/v3/smtp.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/svg.js/2.7.1/svg.min.js"></script>
		<script src="../html2pdf/dist/html2pdf.bundle.min.js"></script>
		<script type="module" src="../js/main.js"></script>
		<h1>Mineral Identification and Classification</h1>
		<div id="labActivity">
			<h2 id="mineralNum">Mineral 1/42</h2>
			<div id="mineralPics" style="text-align: center; margin-top: 2em"></div>
			<h2 id="stepNum">Step 1</h2>
			<h3 id="desc"></h3>
			<div id="mineralNameDiv" style="text-align: center;">
				<input id="mineralName" type="text"/>
			</div>
			<div id="assignment" style="text-align: center; margin-top: 2em"></div>
		</div>

		<div id="summeryQuestions" style="margin-top: 2em">
			<p style="padding-left: 35em; padding-bottom: 1em">How would you distinguish between the following mineral pairs?</p>
			<ol style="padding-left: 37em; list-style-type: decimal; padding-bottom: 5em">
				<li>quartz and albite feldspar
					<input id="1.a" type="text"/>
				</li>
				<li>muscovite and biotite mica
					<input id="1.b" type="text"/>
				</li>
				<li>albite and orthoclase feldspar
					<input id="1.c" type="text"/>
				</li>
				<li>serpentine and chlorite
					<input id="1.d" type="text"/>
				</li>
				<li>olivine and quartz
					<input id="1.e" type="text"/>
				</li>
				<li>hornblende and augite
					<input id="1.f" type="text"/>
				</li>
				<li>pyrite and chalcopyrite
					<input id="1.g" type="text"/>
				</li>
				<li>calcite and halite
					<input id="1.h" type="text"/>
				</li>
				<li>magnetite and galena
					<input id="1.i" type="text"/>
				</li>
			</ol>
		</div>
		
		<div id="inputs" style="text-align: center">
			<p>Enter your name in the box below, then press submit.</p>
			<input id="studentName" type="text"/>
			<input type="button" onclick="downloadPDF()" type="button" value="download" hidden="true" />
			<input type="button" onclick="submit()" type="button" value="submit"/>
			<script type="text/javascript">
				function downloadPDF(){
					var scoreDiv = document.getElementById("score");
					var name = document.getElementById("studentName");
					html2pdf().from(score).set({
				          margin: 0.5,
				          filename: name.value + '-results.pdf',
				          html2canvas: { scale: 2 },
				          jsPDF: {orientation: 'portrait', unit: 'in', format: 'letter', compressPDF: true}
				        }).save();
				}

				function submit() {
					

					var ans = [document.getElementById("1.a").value, document.getElementById("1.b").value, document.getElementById("1.c").value
							,document.getElementById("1.d").value, document.getElementById("1.e").value, document.getElementById("1.f").value
							,document.getElementById("1.g").value, document.getElementById("1.h").value, document.getElementById("1.i").value];

					console.log(ans)

					for (let i = 0; i < ans.length; i++) {
						console.log("ans[i] = " + ans[i])
						if (ans[i] == ""){
							alert("Please answer all summery questions.");
							return;
						}
					}

					if (document.getElementById("studentName").value == ""){
						alert("Please enter your name.");
						return;
					}

					document.getElementById("score").innerHTML += "<p style='margin-top: 2em'>Summery question responses</p>";
					for (let i = 0; i < ans.length; i++){
						document.getElementById("score").innerHTML += ("<p style='margin-top: 1em;'>" + (i + 1) + ". " + ans[i]);
					}

					// submit
					sendEmail();
				}


				function sendEmail() {
					var name = document.getElementById("studentName");
					Email.send({
						Host: "smtp.gmail.com",
						Username : "GeologyLabGradeReports@gmail.com",
						Password : "P5tCsDDC89druPC",
						To : 'isaacbevis123@gmail.com',
						From : "GeologyLabGradeReports@gmail.com",
						Subject : name.value + " grade report",
						Body : document.getElementById("score").innerHTML,
						
					})
					.then(function(message){
						alert("assignment submitted succsefully");
					});
				}
			</script>
		</div>
		
		<div id="score" hidden="true"></div>

	</body>
</html>